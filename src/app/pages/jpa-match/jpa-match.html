<header>
    <div class="row">
        <div class="col-4">
            <button class="back-btn d-flex justify-content-start" (click)="goBack()">
                <mat-icon class="me-1 py-auto">arrow_back</mat-icon>
                <span class="align-top">戻る</span>
            </button>
        </div>
        <div class="col-4 text-center">
            <span class="titie">JPR match!</span>
        </div>
        <div class="col-4 fs-6 text-end">
            <span>開始時刻 {{startTime | date : 'hh:mm'}}</span>
        </div>
    </div>
</header>

<main>
    <!-- プレイヤー情報 -->
     <!-- todo : 手番をハイライト -->
    <div class="player-board row mb-2">
        <ng-container *ngFor="let player of players">
            <div class="col-6">
                <div class="fs-3 mb-1 text-center">{{player.name}}</div>
                <div class="d-flex justify-content-center px-2 mb-4 fs-5">
                    <div class="me-3">SL: {{player.skillLevel}}</div>
                    <div>Goal: {{player.goal}}</div>
                </div>
                <div class="text-center fs-1">{{getScore(player.id)}}</div>
            </div>
        </ng-container>
    </div>

    <!-- ゲーム情報 -->
    <div class="row fs-4">
        <div class="col-4 text-center">Rack:{{currentRack}}</div>
        <div class="col-4 text-center">Inning:{{currentInning}}</div>
        <div class="col-4 text-center">Dead:{{deadCount}}</div>
    </div>
    <!-- イニング内容 -->
    <div class="py-2 px-4 border-top border-bottom border-3 mb-2">
        <ng-container *ngFor="let inningRecord of inningRecords; let i = index">
            <div class="row fs-5 border-bottom " style="min-height: 1.5rem;">
                <!-- プレイヤー１ -->
                <div class="col-5">
                    <ng-container *ngIf="inningRecord.isBreakPlayer1">Break</ng-container>
                    <ng-container *ngFor="let ball of inningRecord.player1Pockets">

                        <img class="pockets" src="assets/images/ball/ball_{{ball}}.svg" alt="球{{ball}}">
                    </ng-container>
                    <ng-container *ngIf="inningRecord.isSafetyPlayer1">S</ng-container>
                </div>
                <!-- イニング数 -->
                <div class="col-2 text-center">
                    <ng-container *ngIf="inningRecord.inning === currentInning">*</ng-container>
                    <ng-container *ngIf="inningRecord.inning !== 0">{{inningRecord.inning}}</ng-container>
                </div>
                <!-- プレイヤー２ -->
                <div class="col-5">
                    <ng-container *ngIf="inningRecord.isBreakPlayer2">Break</ng-container>
                    <!-- todo : 画像取得メソッド -->
                    <ng-container *ngFor="let ball of inningRecord.player2Pockets">
                        <img class="pockets" src="assets/images/ball/ball_{{ball}}.svg" alt="球{{ball}}">
                    </ng-container>
                    <ng-container *ngIf="inningRecord.isSafetyPlayer2">S</ng-container>
                </div>
            </div>
        </ng-container>
    </div>
    <!-- ボール -->
    <ng-container *ngFor="let row of [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]]">
        <div class="row justify-content-around mb-2">
            <ng-container *ngFor="let ball of row">
                <div style="width: 20%;">
                    <ng-container *ngIf="ball!==10" ngIfElse="">
                        <button class="image-container ball-highlight" [disabled]="isDisabled(`ball${ball}`)" 
                        [hidden]="isHidden(`ball${ball}`)" [class.ball-highlight]="isHighlight(`ball${ball}`)" (click)="clickBall(ball)">
                            <img src="assets/images/ball/ball_{{ball}}.svg" alt="球{{ball}}">
                        </button>
                    </ng-container>
                </div>
            </ng-container>
        </div>
    </ng-container>
    <!-- ボタン -->
    <div class="row">
        <!-- deadボタン -->
        <div class="col-3">
            <button [disabled]="isDisabled('btnDead')" (click)="clickDead()">
                <div class="image-container">
                    <img src="assets/images/button/dead.svg" alt="dead">
                </div>
                <div class="button-text">dead</div>
            </button>
        </div>
        <!-- safetyボタン -->
        <div class="col-3">
            <button [disabled]="isDisabled('btnSafety')" (click)="clickSafety()">
                <div class="image-container">
                    <img src="assets/images/button/safety.svg" alt="safety">
                </div>
                <div class="button-text">safety</div>
            </button>
        </div>
        <!-- switchボタン -->
        <div class="col-3">
            <button [disabled]="isDisabled('btnSwitch')" (click)="clickSwitch()">
                <div class="image-container">
                    <img src="assets/images/button/switch.svg" alt="switch">
                </div>
                <div class="button-text">switch</div>
            </button>
        </div>
        <!-- undoボタン -->
        <div class="col-3">
            <button [disabled]="isDisabled('btnUndo')" (click)="clickUndo()">
                <div class="image-container">
                    <img src="assets/images/button/undo.svg" alt="undo">
                </div>
                <div class="button-text">undo</div>
            </button>
        </div>
    </div>
</main>